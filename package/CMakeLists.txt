SET(CPACK_PACKAGE_DESCRIPTION_SUMMARY "QuarkslaB Dynamic binary Instrumentation")
SET(CPACK_PACKAGE_VENDOR "Quarkslab")
SET(CPACK_DEBIAN_PACKAGE_MAINTAINER "Charles Hubain <chubain@quarslab.com>")
SET(CPACK_PACKAGE_VERSION_MAJOR "${QBDI_VERSION_MAJOR}")
SET(CPACK_PACKAGE_VERSION_MINOR "${QBDI_VERSION_MINOR}")
SET(CPACK_PACKAGE_VERSION_PATCH "${QBDI_VERSION_PATCH}")
SET(CPACK_SYSTEM_NAME ${PLATFORM})
if ("${PLATFORM}" STREQUAL "win-X86_64")
	SET(CPACK_GENERATOR "NSIS64")
else()
	SET(CPACK_GENERATOR "TGZ")
endif()
if(FULL_PACKAGE)
    SET(CPACK_SET_DESTDIR true)
    SET(CPACK_PACKAGING_INSTALL_PREFIX ${CMAKE_INSTALL_PREFIX})
    SET(CPACK_INCLUDE_TOPLEVEL_DIRECTORY "./")
    SET(CPACK_COMPONENTS_ALL "QBDI;QBDITemplate;QBDIFridaTemplate")
    SET(CPACK_DEBIAN_PACKAGE_DEPENDS "libncurses5, zlib1g")
else()
    SET(CPACK_COMPONENTS_ALL "QBDI")
endif()
SET(CPACK_RESOURCE_FILE_WELCOME "${CMAKE_CURRENT_SOURCE_DIR}/Welcome.txt")
SET(CPACK_RESOURCE_FILE_README "${CMAKE_CURRENT_SOURCE_DIR}/Readme.txt")
SET(CPACK_RESOURCE_FILE_LICENSE "${CMAKE_CURRENT_SOURCE_DIR}/../LICENSE.txt")

# Configure NSIS
configure_file(NSIS_gen.in NSIS_gen.nsh)

INCLUDE(CPack)

if(UNIX AND NOT ("${PLATFORM}" STREQUAL "android-ARM"))
    add_custom_target(docker_packager
        WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/../package/
        COMMAND "sh" launch_docker_packager.sh
    )
endif()
